
var GIAPI={demo:{dabEndpoint:"http://papeschi.essi-lab.eu:8085/gi-cat/"},logger:{enabled:!1,info:{stringify:function(){return JSON.stringify(this,null,4)}},warn:{stringify:function(){return JSON.stringify(this,null,4)}},error:{stringify:function(){return JSON.stringify(this,null,4)}},log:function(t,e){if(GIAPI.logger.enabled)switch(e||(e="info"),e){case"info":GIAPI.logger.info[GIAPI.isoDateTime()]=t;break;case"warn":GIAPI.logger.warn[GIAPI.isoDateTime()]=t;break;case"error":GIAPI.logger.error[GIAPI.isoDateTime()]=t;break;default:return}}},random:function(){return Math.random().toString(36).slice(2)},query:function(t,e,i,r,n,a,s){var o=i?i.start||1:1,u=i?i.pageSize||10:10,c=e?e.where||"":"";c&&(c=c.west+","+c.south+","+c.east+","+c.north);var m=e?e.when||"":"",l=m?m.from:"",h=m?m.to:"";l&&(l=-1===l.indexOf("T")?l+"T00:00:00Z":l),h&&(h=-1===h.indexOf("T")?h+"T00:00:00Z":h);var f=e?e.what||"":"",p=i&&i.searchOperator?" "+i.searchOperator+" ":" OR ",y="";if(Array.prototype.isArray(f)){for(var d=0;d<f.length;d++)y+=f[d]+p;y=y.substring(0,y.length-4)}else y=f;var g=i?i.searchFields||"":"",v="";if(y&&g)if(Array.prototype.isArray(g)){for(var d=0;d<g.length;d++)v+=g[d]+",";v=v.substring(0,v.length-4)}else v=g;var T=e?e.who||"":"",A=t.endsWith("/")?"":"/";s||(s=GIAPI.random());var I=n?n:"",M="",b="";if(i&&i.extension)if(b="string"==typeof i.extension.relation?i.extension.relation:i.extension.relation.value,i.extension.concepts){y="";var S=i.extension.concepts;if("string"==typeof S)M=S;else{for(var d=0;d<S.length;d++){var D=S[d],w=D.uri();M+=w+","}M=M.substring(0,M.length-1)}}else y=i.extension.keyword;var N=null;N=i&&i.aggregate?"opensearch?reqID="+s+"&aggregate=true&":M||b?"opensearchsemanticenhanced?reqID="+s+"&semExec=expand&":"opensearch?reqID="+s+"&";var P=t+A+"services/"+N;return P+="si="+o+"&",P+="ct="+u+"&",P+="st="+y+"&",P+="searchfields="+v+"&",P+="bbox="+c+"&",P+="ts="+l+"&",P+="te="+h+"&",P+="targetId="+I+"&",a&&(P+="sources="+a+"&"),(r||T)&&(P+="parents="+(r?r:T)+"&"),P+="subj="+encodeURIComponent(M)+"&rela="+b+"&outputFormat=application/json",GIAPI.logger.log("query: "+P),P},status:function(t,e,i){var r=t.endsWith("/")?"":"/",n=e?"&semantic=true":"";return t+r+"services/status?id="+i+"&format=application/json"+n},concept:function(t,e,i,r,n){var a=t.endsWith("/")?"":"/",s=GIAPI.random(),o="";if(!e)if(e="",r){for(var u=[],c=0;c<r.length;c++){var m=r[c];"string"==typeof m?u.push(m):u.push(m.value)}o=u}else{var l="";for(name in GIAPI.Relation)"NONE"!==name&&"decode"!==name&&(l+=GIAPI.Relation[name].value+",");o=l.substring(0,l.length-1)}var h=n&&n.start?n.start:1,f=n&&n.count?n.count:10,p=n&&n.topLevel?n.topLevel:"false";i=encodeURIComponent(i);var y=t+a+"services/opensearchsemanticenhanced?semExec=suggestion&si="+h+"&ct="+f+"&reqID="+s+"&st="+e+"&topLevel="+p+"&subj="+i+"&rela="+o+"&outputFormat=application/json";return GIAPI.logger.log("concept: "+y),y},access:function(t,e,i,r,n){var a=e.url;a=a.substring(0,a.indexOf("?")),a=a.replace("transformer","http-get");var s="gi-axe-capabilities"===r?"&jsondataoutput=true":"";a+="?service=WPS&request=Execute&identifier="+r+s+"&DataInputs=descriptor=";var o=t;o=o.endsWith("/")?o:o+"/",o+="services/cswiso?request=GetRecordById&version=2.0.2&service=CSW&ElementSetName=full&outputSchema=http://www.isotc211.org/2005/gmi&id=",o+=n,o=encodeURIComponent(o);var u="";if(i){if(o+=";",i.crs&&(u+="outputCRS="+i.crs+";"),i.vectorFormat&&(u+="outputVectorFormat="+i.vectorFormat+";"),i.rasterFormat&&(u+="outputRasterFormat="+i.rasterFormat+";"),i.spatialSubset){var c=i.spatialSubset;u+="outputSubset="+c.west+","+c.south+","+c.east+","+c.north+";"}if(i.temporalSubset){var m=i.temporalSubset;u+="outputTemporalBegin="+m.from+";outputTemporalEnd="+m.to+";"}if(i.resolution){var l=i.resolution;u+="outputResolution="+l.latResolution+","+l.lonResolution}u=encodeURIComponent(u),u+="&RawDataOutput=resource"}var h=a+o+u;return GIAPI.logger.log("access: "+h),h},emptyResultSet:function(t){var e={};return e.size=0,e.pageSize=0,e.start=0,e.pageIndex=0,e.pageCount=0,t&&(e.error=t),e},clone:function(t){return jQuery.extend(!0,{},t)},isoDateTime:function(){return(new Date).format("isoDateTimeMls")}};"function"!=typeof Array.prototype.isArray&&(Array.prototype.isArray=function(t){return"[object Array]"===Object.prototype.toString.apply(t)}),"function"!=typeof Array.prototype.remove&&(Array.prototype.remove=function(t,e){for(var i in t)if(t[i]===e){t.splice(i,1);break}}),"function"!=typeof Array.prototype.distinctValues&&(Array.prototype.distinctValues=function(t){return function(){return this.filter(t)}}(function(t,e,i){return i.indexOf(t,e+1)<0})),"function"!=typeof String.prototype.endsWith&&(String.prototype.endsWith=function(t){return-1!==this.indexOf(t,this.length-t.length)}),function($){$.timer=function(func,time,autostart){return this.set=function(func,time,autostart){if(this.init=!0,"object"==typeof func){var paramList=["autostart","time"];for(var arg in paramList)void 0!=func[paramList[arg]]&&eval(paramList[arg]+" = func[paramList[arg]]");func=func.action}return"function"==typeof func&&(this.action=func),isNaN(time)||(this.intervalTime=time),autostart&&!this.isActive&&(this.isActive=!0,this.setTimer()),this},this.once=function(t){var e=this;return isNaN(t)&&(t=0),window.setTimeout(function(){e.action()},t),this},this.play=function(t){return this.isActive||(t?this.setTimer():this.setTimer(this.remaining),this.isActive=!0),this},this.pause=function(){return this.isActive&&(this.isActive=!1,this.remaining-=new Date-this.last,this.clearTimer()),this},this.stop=function(){return this.isActive=!1,this.remaining=this.intervalTime,this.clearTimer(),this},this.toggle=function(t){return this.isActive?this.pause():t?this.play(!0):this.play(),this},this.reset=function(){return this.isActive=!1,this.play(!0),this},this.clearTimer=function(){window.clearTimeout(this.timeoutObject)},this.setTimer=function(t){var e=this;"function"==typeof this.action&&(isNaN(t)&&(t=this.intervalTime),this.remaining=t,this.last=new Date,this.clearTimer(),this.timeoutObject=window.setTimeout(function(){e.go()},t))},this.go=function(){this.isActive&&(this.action(),this.setTimer())},this.init?new $.timer(func,time,autostart):(this.set(func,time,autostart),this)}}(jQuery),dateFormat=function(){var t=/d{1,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|[LloSZ]|"[^"]*"|'[^']*'/g,e=/\b(?:[PMCEA][SDP]T|(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time|(?:GMT|UTC)(?:[-+]\d{4})?)\b/g,i=/[^-+\dA-Z]/g,r=function(t,e){for(t=String(t),e=e||2;t.length<e;)t="0"+t;return t};return function(n,a,s){var o=dateFormat;if(1!=arguments.length||"[object String]"!=Object.prototype.toString.call(n)||/\d/.test(n)||(a=n,n=void 0),n=n?new Date(n):new Date,isNaN(n))throw SyntaxError("invalid date");a=String(o.masks[a]||a||o.masks["default"]),"UTC:"==a.slice(0,4)&&(a=a.slice(4),s=!0);var u=s?"getUTC":"get",c=n[u+"Date"](),m=n[u+"Day"](),l=n[u+"Month"](),h=n[u+"FullYear"](),f=n[u+"Hours"](),p=n[u+"Minutes"](),y=n[u+"Seconds"](),d=n[u+"Milliseconds"](),g=s?0:n.getTimezoneOffset(),v={d:c,dd:r(c),ddd:o.i18n.dayNames[m],dddd:o.i18n.dayNames[m+7],m:l+1,mm:r(l+1),mmm:o.i18n.monthNames[l],mmmm:o.i18n.monthNames[l+12],yy:String(h).slice(2),yyyy:h,h:f%12||12,hh:r(f%12||12),H:f,HH:r(f),M:p,MM:r(p),s:y,ss:r(y),l:r(d,3),L:r(d>99?Math.round(d/10):d),t:12>f?"a":"p",tt:12>f?"am":"pm",T:12>f?"A":"P",TT:12>f?"AM":"PM",Z:s?"UTC":(String(n).match(e)||[""]).pop().replace(i,""),o:(g>0?"-":"+")+r(100*Math.floor(Math.abs(g)/60)+Math.abs(g)%60,4),S:["th","st","nd","rd"][c%10>3?0:(c%100-c%10!=10)*c%10]};return a.replace(t,function(t){return t in v?v[t]:t.slice(1,t.length-1)})}}(),dateFormat.masks={"default":"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:ss",isoDateTimeMls:"yyyy-mm-dd'T'HH:MM:ss.l",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'"},dateFormat.i18n={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"]},"function"!=typeof Date.prototype.format&&(Date.prototype.format=function(t,e){return dateFormat(this,t,e)});
GIAPI.GINode=function(){var e,r,o=48,a=96,t=144,n=288,s=576,i=96,l=GIAPI.random(),c={},u=arguments[0],p=arguments[1];u?(u.topic&&(u.topic=u.topic.distinctValues()),u.geossCategory&&(u.geossCategory=u.geossCategory.distinctValues()),u.keyword&&(u.keyword=u.keyword.distinctValues())):u={id:""+l,type:"simple",title:"Simple node "+l},c._parent=null,c._id=u.id,c._title=u.title,c.expand=function(o,a){if("simple"===u.type)o.apply(c,[GIAPI.Page([])],GIAPI.emptyResultSet());else{var t=1;4===arguments.length?t=arguments[3]:e=null;var n={};n.start=t,n.pageSize=a;var s=GIAPI.query(d(),null,n,u.id,null);r=o,jQuery.ajax({type:"GET",url:s,crossDomain:!0,dataType:"jsonp",success:function(r){if(e=r.resultSet,e.error)return GIAPI.logger.log("expand error: "+e.error,"error"),o.apply(p,[GIAPI.Page(),e]),void 0;for(var a=[],t=0;t<r.reports.length;t++){var n,s=r.reports[t];n=s.service&&s.service.dabSource===!0?GIAPI.DABSource(s,c):GIAPI.GINode(s,p),n._parent=c,a.push(n)}o.apply(c,[GIAPI.Page(a),e])},complete:function(e,r){GIAPI.logger.log("expand complete status: "+r)},error:function(e,r,a){r+=a.message?", exception -> "+a.message:"",GIAPI.logger.log("expand error: "+r,"error"),o.apply(c,[GIAPI.Page([]),GIAPI.emptyResultSet("Error occurred: "+r)])}})}},c.expandNext=function(o,a){if("simple"===u.type)return!1;if(!e)throw"node not expanded";var t=e.size,n=e.start,s=e.pageSize;if(n+s>t)return!1;if(a){c.expand(r,null,s,n+s)}return!0},c.accessOptions=function(e){var r=g(),o=arguments[1];if(r){var a=GIAPI.access(d(),r,null,"gi-axe-capabilities",u.id);try{jQuery.ajax({type:"GET",url:a,crossDomain:!0,dataType:"jsonp",success:function(r){if(r.error)return GIAPI.logger.log("accessoptions error: "+r.error,"error"),e.apply(c,[null,"Unable to retrieve access options: "+r.error]),void 0;var a=r.defaultOptions.resolution,t=r.defaultOptions.spatialSubset;if(t){var n=t.north-t.south,s=t.east-t.west,l=i;o&&(l=o);var u=Math.max(n/l,s/l);a=a?a:{},a.latResolution=u,a.lonResolution=u,r.defaultOptions.resolution=a}e.apply(c,[r])},complete:function(e,r){GIAPI.logger.log("accessoptions complete status: "+r)},error:function(r,o,a){o+=a.message?", exception -> "+a.message:"",GIAPI.logger.log("accessoptions error: "+o,"error"),e.apply(c,[null,"Unable to retrieve access options: "+o])}})}catch(t){console.log(t)}return!0}return!1},c.accessLink=function(e,r){var o=g();if(o){if(r){var a=GIAPI.access(d(),o,r,"gi-axe-transform",u.id);e.apply(c,[a])}else{var t=function(r,a){if(a)return GIAPI.logger.log("accessOptions in accessLink error: "+a,"error"),e.apply(c,[null,a]),void 0;var t=r.defaultOptions,n=GIAPI.access(d(),o,t,"gi-axe-transform",u.id);e.apply(c,[n])};c.accessOptions(t)}return!0}return!1},c.preview=function(e,r,i){if(!document.getElementById(e))throw"Canvas element not found";var l=g();if(l){var p=function(o,a){if(a)return GIAPI.logger.log("accessOptions in preview error: "+a,"error"),r.apply(c,["error",a]),void 0;var t=o.defaultOptions;t.rasterFormat="png";var n=GIAPI.access(d(),l,t,"gi-axe-transform",u.id),s=new Image;s.onload=function(){var o=document.getElementById(e);o.width=s.width,o.height=s.height;var a=o.getContext("2d");a.drawImage(s,0,0),r.apply(c,["success"])},s.onerror=function(){GIAPI.logger.log("image loading error"),r.apply(c,["error","Unable to load image, error occurred"])},s.onabort=function(){GIAPI.logger.log("image loading aborted"),r.apply(c,["error","Image loading aborted"])};try{s.src=n}catch(i){return GIAPI.logger.log("unable to load image: "+i.message,"error"),r.apply(c,["error","Unable to load image: "+i.message]),!0}};switch(i){case"extra small":i=o;break;case"small":i=a;break;case"large":i=n;break;case"extra large":i=s;break;case"medium":default:i=t}return c.accessOptions(p,i),!0}return!1},c.overview=function(e,r,i,l){var p=u.overview;if(!p)return!1;if(0>r||r>p.length-1)throw Error("index out of bounds, must be >= 0 and <= "+(p.length-1));if(0===!jQuery("#"+e).length)throw Error("div not found");switch(l){case"extra small":l=o;break;case"small":l=a;break;case"large":l=n;break;case"extra large":l=s;break;case"original":l=null;break;case"medium":default:l=t}var g=p[r],d=new Image;l&&(d.width=l,d.height=l),d.onload=function(){jQuery("#"+e).attr("width",l+"px"),jQuery("#"+e).attr("height",l+"px"),jQuery("#"+e).css("width",l+"px"),jQuery("#"+e).css("height",l+"px"),jQuery("#"+e).append(d),i.apply(c,["success"])},d.onerror=function(){GIAPI.logger.log("image loading error"),i.apply(c,["error","Unable to load image, error occurred"])},d.onabort=function(){GIAPI.logger.log("image loading aborted"),i.apply(c,["error","Image loading aborted"])};try{d.src=g}catch(I){GIAPI.logger.log("unable to load image: "+I.message,"error"),i.apply(c,["error","Unable to load image: "+I.message])}return!0},c.olWMS_Layer=function(e){var r=u.online,o=[];if(r)for(var a=0;a<r.length;a++){var t=r[a];if(t.description&&"http://www.essi-lab.eu/broker/accesstypes/complex"===t.description){var n=t.name,s=t.url,i={layers:n};if(e&&e.params)for(key in e.params)i[key]=e.params[key];e&&e.options?o.push(new OpenLayers.Layer.WMS(n,s,i,e.options)):o.push(new OpenLayers.Layer.WMS(n,s,i))}}return o},c.isAccessible=function(){return null!=g()},c.report=function(e){return e&&(u=e),u};var g=function(){if(u.online)for(var e=0;e<u.online.length;e++){var r=u.online[e];if("GI-AXE"===r.protocol)return r}return null},d=function(){return"string"==typeof p?p:p.endpoint()};return c};
GIAPI.DAB=function(e){var r,t,n={id:"ROOT",type:"composed",title:"DAB"},o=GIAPI.GINode(n,e);o._paginator=function(n,s,a,i){var c=GIAPI.random(),p=t&&t===o._includedSources.length?null:o._includedSources,g=GIAPI.query(e,s,a,null,null,p,c),I=arguments[4],d=I._resultSet.extension,f=a&&a.extension&&a.extension.relation&&(a.extension.keyword||a.extension.concepts);i&&(r=l(i,f,c)),jQuery.ajax({type:"GET",url:g,crossDomain:!0,dataType:"jsonp",success:function(e){for(var t=[],l=0;l<e.reports.length;l++){var s=e.reports[l];s.semantic&&delete s.semantic;var a=GIAPI.GINode(s,o);t.push(a)}I._resultSet=e.resultSet,I._page=GIAPI.Page(t,I.pageSize),d&&(I._resultSet.extension=d),n.apply(o,[[I]]),r&&r.stop()},complete:function(e,t){GIAPI.logger.log("_paginator complete status: "+t),r&&r.stop()},error:function(e,r,t){u(r,t,n)}})},o.discover=function(n,s,g,I){var d=g&&g.extension?g.extension:null;if(d&&d.relation&&!d.keyword&&!d.concepts)throw"Unable to expand discover, only relation selected. Please select keyword or concepts";if(d&&!d.relation&&(d.keyword||d.concepts)){var f=d.keyword?"keyword selected":"concepts selected";throw"Unable to expand discover, only "+f+". Please select a relation"}var y=g&&g.extension&&g.extension.relation&&(g.extension.keyword||g.extension.concepts),v=GIAPI.random(),S=t&&t===o._includedSources.length?null:o._includedSources,h=c(s)||c(g),G=i(s)||i(g),P=GIAPI.query(e,h,G,null,null,S,v),x=arguments,m=p(s)||p(g)||p(I);m&&(r=l(m,y,v));var A=g&&g.timeout?g.timeout:0;jQuery.ajax({type:"GET",url:P,crossDomain:!0,dataType:"jsonp",timeout:A,success:function(e){if(e.resultSet&&e.resultSet.error){GIAPI.logger.log("discover error: "+e.resultSet.error,"error");var t=GIAPI.Paginator();return t._resultSet=e.resultSet,n.apply(o,[[t]]),void 0}for(var l=[],s=[],u=null,i=null,c=null,p=null,g=null,I=0;I<e.reports.length;I++){var d=e.reports[I],f=d.semantic;if(f){var y=f.matchKeyword,v=parseInt(f.matchCount);if(y!==u||I===e.reports.length-1){if(u){I===e.reports.length-1&&s.push(GIAPI.GINode(d,o));var S=GIAPI.clone(x);S.length=x.length,S.callee=x.callee,S[S.length]=o;var h=u.indexOf("----")+4;if(u=u.substring(h,u.length),c){S[1].what=null,S[2].extension.keyword=null,S[2].extension.relation="none";var G=encodeURIComponent(c);S[2].extension.concepts=G}else S[1].what=u,S[1].subject=null,S[1].relation=null,S[2].extension=null;var P={};P.size=i,P.pageSize=parseInt(e.resultSet.pageSize),P.start=1,P.pageCount=a(i,P.pageSize),P.pageIndex=parseInt(e.resultSet.pageIndex),P.extension={},P.extension.size=e.resultSet.size,P.extension.resultSetIndex=l.length+1,P.extension.label=u,P.extension.uri=c||"none",P.extension.scheme=p||"none",P.extension.language=g||"none";var t=GIAPI.Paginator(S);t._resultSet=P,t._page=GIAPI.Page(s,t.pageSize),l.push(t),s=[]}u=y,i=v,c=f.term,p=f.scheme,g=f.label&&f.label.language?f.label.language:"none"}}d.semantic&&delete d.semantic,s.push(GIAPI.GINode(d,o))}if(0===l.length){x[x.length]=o;var t=GIAPI.Paginator(x);t._resultSet=e.resultSet,t._page=GIAPI.Page(s,t.pageSize),l=[t]}else if(1===l.length)t._resultSet.extension&&delete t._resultSet.extension;else for(var I=0;I<l.length;I++)l[I].resultSet().extension.width=l.length;n.apply(o,[l]),r&&r.stop()},complete:function(e,t){GIAPI.logger.log("discover complete status: "+t),r&&r.stop()},error:function(e,r,t){u(r,t,n)}})},o.node=function(r,t){var n=GIAPI.query(e,null,null,null,r,null,null);jQuery.ajax({type:"GET",url:n,crossDomain:!0,dataType:"jsonp",success:function(e){if(e.resultSet&&e.resultSet.error)return GIAPI.logger.log("node error: "+e.resultSet.error,"error"),t.apply(o,[null,"Error occurred:"+e.resultSet.error]),void 0;var r=null;if(1===e.reports.length){var n=e.reports[0];r=GIAPI.GINode(n,o)}t.apply(o,[r])},complete:function(e,r){GIAPI.logger.log("node complete status: "+r)},error:function(e,r,n){r+=n.message?", exception -> "+n.message:"",GIAPI.logger.log("node error: "+r,"error"),t.apply(o,[null,"Error occurred: "+r])}})},o.sources=function(e){o.expand(function(r,n){var l=[];if(n.error)e.apply(o,[l,n.error]);else{var s=r.nodes();t=s.length,o._includedSources=[];for(var a=0;a<s.length;a++){var u=s[a],i=u.report(),c=GIAPI.DABSource(i,o);l.push(c),o._includedSources.push(i.id)}e.apply(o,[l])}},30)},o.concept=function(r,t,n){var l=GIAPI.concept(e,r,"",[],n);jQuery.ajax({type:"GET",url:l,crossDomain:!0,dataType:"jsonp",success:function(r){if(r.resultSet&&r.resultSet.error)return GIAPI.logger.log("extend concept error: "+r.resultSet.error,"error"),t.apply(o,[[],"Error occurred:"+r.resultSet.error]),void 0;for(var n=r.concept,l=[],s=0;s<n.length;s++){var a=n[s],u=GIAPI.Concept(e,a);l.push(u)}t.apply(o,[l])},complete:function(e,r){GIAPI.logger.log("concept complete status: "+r)},error:function(e,r,n){r+=n.message?", exception -> "+n.message:"",GIAPI.logger.log("concept error: "+r,"error"),t.apply(o,[[],"Error occurred: "+r])}})},o.endpoint=function(){return e};var l=function(e,r,t){var n=function(e,t,n){return function(){return e(t,r,n)}},o=jQuery.timer(n(s,e,t));return o.set({time:1e3,autostart:!0}),o},s=function(t,n,o){var l=GIAPI.status(e,n,o);jQuery.ajax({type:"GET",url:l,crossDomain:!0,dataType:"jsonp",success:function(e,n){for(var o,l=[],s=0;s<e.discoverStatus.length;s++){var n=e.discoverStatus[s],a=GIAPI.SourceStatus(n);"DAB"===a.title()&&(o=a),l.push(a)}t.apply(this,[l]),o&&100===o.progress()&&r.stop()},complete:function(){t.apply(this,[])},error:function(){t.apply(this,[]),r.stop()}})},a=function(e,r){var t=parseInt(e),n=parseInt(r);return parseInt(n>t?"1":Math.ceil(t/n))},u=function(e,t,n){e+=t.message?", exception -> "+t.message:"",GIAPI.logger.log("error occurred: "+e,"error"),r&&r.stop();var l=GIAPI.Paginator();l._resultSet=GIAPI.emptyResultSet(e),l._page=GIAPI.Page([]),n.apply(o,[[l]])},i=function(e){return e&&(e.start||e.pageSize||e.extension)?e:null},c=function(e){return e&&(e.where||e.when||e.what||e.who)?e:null},p=function(e){return e&&"function"==typeof e?e:null};return o};
GIAPI.Page=function(n,t){if(n&&!Array.isArray(n))throw"nodes is not an array";var r=0;return{next:function(){return r===n.length?null:n[r++]},hasNext:function(){return r<n.length},nodes:function(){return n},size:function(){return t||"10"},count:function(){return n.length},reset:function(){r=0}}};
GIAPI.Paginator=function(){if(arguments&&arguments.length>0)var t=arguments[0][1],e=arguments[0][2],r=arguments[0][3],a=arguments[0][4];var n,s={};return s._id="paginator_"+GIAPI.random(),s.next=function(u,i){if(!s._resultSet)throw"Paginator not ready";var o=s._resultSet.size,g=s._resultSet.start,_=s._resultSet.pageSize,S=s._resultSet.pageCount,l=s._resultSet.pageIndex;return n||(n=g),o&&l!==S?i?(n+=_,e||(e={}),e.start=n,a._paginator(u,t,e,r,this),!0):!0:!1},s.prev=function(u,i){if(!s._resultSet)throw"Paginator not ready";var o=s._resultSet.size,g=(s._resultSet.start,s._resultSet.pageSize),_=s._resultSet.pageIndex;return o&&1!==_?i?(n-=g,e||(e={}),e.start=n,a._paginator(u,t,e,r,this),!0):!0:!1},s.first=function(u,i){if(!s._resultSet)throw"Paginator not ready";var o=s._resultSet.size,g=s._resultSet.pageIndex;return o&&1!==g?i?(n=1,e||(e={}),e.start=n,a._paginator(u,t,e,r,this),!0):!0:!1},s.last=function(u,i){if(!s._resultSet)throw"Paginator not ready";var o=s._resultSet.size,g=s._resultSet.pageCount,_=s._resultSet.pageIndex,S=s._resultSet.pageSize;return o&&_!==g?i?(n=(g-1)*S+1,e||(e={}),e.start=n,a._paginator(u,t,e,r,this),!0):!0:!1},s.skip=function(u,i,o){var g="function"!=typeof u?u:i;if(i=parseInt(g),!s._resultSet)throw"Paginator not ready";var _=s._resultSet.pageCount,S=s._resultSet.pageSize,l=s._resultSet.pageIndex;return i===l||1>i||i>_?!1:o?(n=(i-1)*S+1,e||(e={}),e.start=n,a._paginator(u,t,e,r,this),!0):!0},s.page=function(){return s._page},s.resultSet=function(){return s._resultSet},s};
GIAPI.SourceStatus=function(A){return{id:function(){return A.id},title:function(){return A.title},progress:function(){return parseInt(A.progress)},message:function(){return A.message},phase:function(g){if(!g)return A.phase;switch(A.phase){case"INIT":return this.INIT_DATA_URL;case"DISTRIBUTION":return this.DISTRIBUTION_DATA_URL;case"VALIDATION":return this.VALIDATION_DATA_URL;case"DECODING_REQUEST":return this.DECODING_REQUEST_DATA_URL;case"NETWORK_WAITING":return this.NETWORK_WAITING_DATA_URL;case"DECODING_RESPONSE":return this.DECODING_RESPONSE_DATA_URL;case"JOIN":return this.JOIN_DATA_URL;case"PROCESSING":return this.PROCESSING_DATA_URL;case"COMPLETED":return this.COMPLETED_DATA_URL;case"ERROR":return this.ERROR_DATA_URL;case"TIMEOUT":return this.TIMEOUT_DATA_URL}},INIT_DATA_URL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADKUlEQVQ4T21TW0gUURj+zszszM7OurvOupar5m4rrZZam21WFoViFBQ9BN2oMJIosBChQopKeunNhx6KiIQigi4PvkhFdyGDoqCLBLJpdHHV3JtuOe7OTGemFKEGPv5z+b/vnPPP9xP856s4UB0o9gXqJpi0j2MJES1ifCQSffrqfM9Lmq7PppDZk+rDdYFAme8sxzM7oWjgRQFE16FaNaiiDk7lXvz8nG69dfRq7zRvRqDh9NZl3kLPAyYNp9sjwyZLIBzd5mgqCyhZBUPDUVhcApQfmUPX9l64aIiYAsGm5f4loco3OWnBWRAoAHgClagYy8SRVJNIqCnEtDh+YRKZEQU1vjBG+5Ibu9tu3DUF1p7ZdLWAce8pDQbMEyem0ljpDWNZUQgsy+JjvB+XI9fQm6IlyABSworykoVfunZc95M5e4L+ed7CT7XF1bDl2RFNRNFYtRP5cj4YhoHFYjFhjFt7T+DZEH2+oiOf8YD9zm4jlUdW7RM14cr6mnWIxAYRkiuwoiQMQgisVitEUTSjgeHJUWzu2gE9q4NVGMgWz0VS09bQLmr8qQpfEB+H+7ElsAF5nGwSjZMlSYLD4TCjMd/bfRCR+AD0KcBpz+0h4eP17XaIp1xSDlKZcazODcPN5cJms8Fut5tEA4Ygz/NofnQMA8nPQBZUWO4hVS1rWtiE2iHn50KnBfSzRShzlM4QDaFpcjI7juanxwCNVn5Sx1zZe4nM2bVgvtvmisicA0Ri8G30G5oqdkO0/Hm/AUEQzHjhbSdej70FVJ2uichj8prM31jZsvqJ8im1Vi52o38kAqeYgw3z67HIEzSvHcsmcP/rE7yL9ZlG1tIq5gaLku9PPveYAt79i0OyVXqsDKacMS5JvUCoCw0H0m3qQmLEv57VMxpcXjf4jLC9r+PFzRkrLzq8olFX9M7RgSGoFg1EMMhUiKFCBgzbKoDL74FV59vedfSem7HydGOUHqhe6nI4O7kJVE39VPArOwmd0WCl9ZBcdmRy8GUinm7tO//89j/NNLsrQ0fW1JeXlDW4nXKtwPFkbDz24fuP6MN77Xfu0Dx1du5vpjUHBLzx3/8AAAAASUVORK5CYII=",DISTRIBUTION_DATA_URL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAOCAYAAAAmL5yKAAACPElEQVQoU2NkwA44GTyLznKr+mh+vb3lOsP2PmOgsu/YlDJi1a9u0cHr2VX+9+8vBmZmNobP28s6GW6eqCDeAIeU83yGCQZ//vxgYGHhYPh0fsEFhgNzDIk3QMWwkd9vSt2fPz+BBrAzfNyU08Rw53w98QaAVGrZ9LLblRf9PNTZx3DtSDGOsGJADgNOBnZ2GaDC/ww/mX4w8HBaMPq3rv6/sTqU4cv3Ewzs/ziAcowMP38+QQ5QmAFiDEFNB1kEVDT+/fn1H2wbEzMDO5cI489vb/4z/PsLEWJhY/zz4c4NhnV19kDuK5AYxAA2Hi2mqGln/63O9QGL/f37m4GbT4/Ju3nSv621eQxfP10CRgcryHVMoZO3/FuWZczw68s1mAGiDFp2dex2ZZk/t1eWMTy83Ac2VMO2m92hrOTnga4ehhuHS8Fi8rpF7J7tXT8PdU1nuHaoCSjympHBo/gOj7qv8v///8Bx/mllQgoDG6cIf9CMDngsrMuoYPj1/Q1f+II5oLTByMjE8OXm5rsMO3pVGLnz9v0HaQYBcJyfmLCXgZmDn880wwSeDk7POMPw98dHPosCZ5AY2OlAQ75OcmJkZPCrvcUpa6PKCAw0JiYWhi9rMgsZOLn5eX36GuApcUtRA8P3rx95Qqb3//v3h+E/MFC/Pz5ym2FTsxojA4+AA4NT7ixuBUfVr1dX3WTYO8MEaMEvYF64gJQXDEBBzeCccYZbO0z964P9txn2TU5j+PLhAPa8AHYkcQAAFZXhD6YckjcAAAAASUVORK5CYII=",VALIDATION_DATA_URL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAC7ElEQVQ4T3WTW0iTYRjHn+/TzePmZO7g3GDTqbPZSIiwwFJsmXgjhV1kB2WywC7ydBGTaCYkCFmYSexGM2jEiLTw0FLTmlB5SNfKabVWqJjbch72be5z3/oUFU194b15eP6/9/nz/F8E9j8ihUIRK5PJWDqd7qfBYDCRra7/25G99BUVFZVKpbJSJBIRXq/X7na7AzUaTZ9KpSoh++3bNbsAWq02Jzs7R+f3Ew4URbCgoCDwA1BmZ/9w6+ruaO/X1xeTgJVNyC6AxWLpCg+nSX0+AgsOpgLuI5huzB2J4zhqNI5h6pu3Mo3Gkff7Avr6+mcEAsEShUIJRQMCWCgaEEQQPsDxVXC5lqG69t7nJFHScbW61LkG2TWBXv+6jcvlpgVSqJF0Og1QBAUvjoNnxQO/rFYwmi3g8nhGgUJkqEtLnTsA11U3CpaXFu9eyD/PoNHpsOYfQRDAMAzIiaCzSw9H09LBPDEBjY2NbR/f9eRuAcqrbjd75x2Xi4uvQsfLVhCL4+CkXL5udcHphNa2l5AolUFyshQmJyahqqYGTsizyzYBCJvNbr5YeOUSmxECkgNSWFhcBBaLDaQVWCX8wOXx1yeiUqkwNDgI7R2dlt7erjPbLfAThOyhaGYEJ16aAlMOD6yQvosURSDPOg0+ggC73QFfx8fhQUN9y9sevYocbmYLIOaFprCYUSMxvGg4nJkHNvtfmJ6eAgGLgLyMYHj8JgRGTd9s9jmbatw4/IQUY1tbEDKAERYR8UmSKBF+GB57deqsIosXzQIpxwpCLgqmuXgYMzu7mx5pyl3z819IoW9HDiQxYU0JEmmBY/pHy4DZUcHhcBqulZWcOygi4PscAzP0G6qf6bQPSdH67ndEOYEXmhvDFzynUf2WF4bJtDVf5GUfST02kF+odNfWqJXTVuswWcP3+jfIIXHUfFyskDphHs81/XZ1k01k9NcDxt/IvG2jtpcekNRkYTqTivHbR+ae7vfKnsqN4j/7KSLQfZStLgAAAABJRU5ErkJggg==",DECODING_REQUEST_DATA_URL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADU0lEQVQ4T22TWUxTaRTH/1/pxZaW1lhaKAWxVqTCWJUiIHGZ+OCSkWjc4hKNOiSExAeXmJi4jGZi4gtGo4k+gBHimBlEfZghmnGJ0QdFlGiMKIyOUlahLN3uvvj1jhIS5yYnN/fec373/P/nOwT/cwWXH/JNzw+slSXVoRGFMEaDNNj3T8uTv0610XRtcgmZ/FCx+qivqHjpr6mmtK2aEkEKEaEqCaiwQuDHkvdQZPRz1a26vXe/1U0ANlQ3luT55t3T1LDdleGC2TIVmiJCYkdAGBM4NoreUAeMTBp4Tqq5XLv7UhKiA4I/HswoX7H9vYWJ2nO8cwFVgiSK8Nr6URbMQ921p3jWBbDxGPh4P4r8LgwMRze3XNl3XQds2veoMdtt3pGfXwBVlTEUZvF5OI4ti1kEfsgFy7I4feEB2t7KUGQWROnDLJ+vp+lStZd4/DsdZatqwiWBDKTbsxDqZxGJ0ojEkBh6i7NHS8EwBnAch9qLD/G8U4AisbBaxqlEy8+kYl3thuyZZc3Ll5VgoG8ABnEQiQSH8EgcCvXAbYth+8YkhFAIj/P1j9DexVOJ3bBZ3VdJZc2dk85M/3G/PwuFtnYEF3ihaRoIIVSOCkmSIAgiDR48L9DgcaL2PgZHOJhMpsfkp+o7J7Ny5hx3OF2o8LRhbmEOLf7P3yRAlmUdIorJYgFjo1GcqXtKATymmFIfk2Ubz25y5JY3efICUOL/IjHWQ42i86dmaqoIp3kcO7eUUoCoR/3vL/DqvUjldMFhn3GNzF64f2ZB+a4PTpcFTOo0dHfHKCChu53Cv8PhPbkwmY20CxmX/3iJ1x+hmyiJIUy1ZVXpza6uuv9byhRmW6anCH291LyvgDWBDhTPz9OlNDR34E0oVQez0U46sczIUO+gVwcku/CX726HxtoF1Q31K2Ce8wUqV85G481OdPSm0/csuFgPnYgGo8FY9fzvX+onjvKSdWdKbZ6ld0eHO23mdD9dGQ0SNwp+vBtGawYUMQ4+8YE6n0a/kYZnLYd2TRzlb4sRrLxQ7M4uOGdkhMWKIoMTwrR9ESmKQv8KSHxaT3Ss/0Dr7WPN3y3T5K1ctOZIaWFg4fpMh32+gcAaiYy0fvoUav2z4cANmqdMzv0C2tGZc8nM+tEAAAAASUVORK5CYII=",NETWORK_WAITING_DATA_URL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACMUlEQVQ4T62TS2gTURSG/5kkk2RaCUkfxle1rRpcxNrUVUHBRYoUuqqbikXBRQhJC4IogkIFxY0ItonRUsSFKEgw1AdCKyJIfay0Dx/VvKTJpBgnsTFpMpnMxLFilEljNt7Vvedyv/vzcQ4B2bLb7QMkSfbI6/KzKIr3PR7PCCG/cDgcEy6Xy1oN4HQ6J91ud1dFgNE6BEKhKuMoaQMW7tpRFbC++wKUdGMZgK5V48ONQ/8RsIo0i8lkqnvyJgwoqFIChtMhlmlAWYJq0pjkMr7lebz7/AmpbA5+hsRBSz2ujgz/kvgbIJdGSHr3d+3AmaNWEEIei3E/WJ5GRNiM2dfvwUyMBn23rreWAHJpbWY9Bg4U8YWdAa22gKIaEY5HEMl2IMlp4H/2Ev6H5/srAo70taNzewDTwTvQUM1AQYf5UAzh7GFo6Rok56X91EVvRcDxwR7oVD7Mvh1HQVBAS2gR5feAFbshxFkkAimwfl+sBGjqHcMaPV2yvq9zNyBeQTTyCDRlQOE7BcF4GlBvQ2KGgZgnpFrwD0DeMcMPQnj8MYRM9CSUMKBGdwoc34J0QpAScWjbWYuvwRde4u8+MJvNepvNJn0NvJoO4MQ1AkVyCXzOC7WqHdk0CZFYwKbmjWjasgupOV//yiys1gtFqX773hwujWpQFBoA/VOQCgdyywzqDYPYatx7duxc79AK4F8jvMTXrQtGOwoZjlpbUB9DejExtcHQN/588vLNn29/AOPlFct62uwRAAAAAElFTkSuQmCC",JOIN_DATA_URL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAOCAYAAAAmL5yKAAAB/0lEQVQoU6WTS2jUUBSGv3QycdpJE4Xqyo2PqvVFtV2ICxVFtOiiCONrUQQf4EawvgpCrV3VVwU3gg+QLlQcEBdKFVHQhbhotfiqtlU3rqQLEzPtNJNpPMk041AqFEzu5ZI/53z33D8nCv95KWG+zobKbVxTF1LtvuFLppt6UV29kb74MmpyH+l3HlArmpZsoEdbzWJviMHfjzgUAip3MaDOo5oyUGT+6uJoWQLT2E2b74mmgn2XtvEs1swmLvvjkiTT+85gCJh1Gl/u8FLiMPKcZ5Jklq+j3s8VtNGX9AjMqtjIpkArBIdDTtDIkLacBb5Agt2smxxQNKqMJjoigN1Fi+8ybO7nRliVZLof+FrwAGbHV9Ca3MJh5z4nvW90BqJALyS3cjzzmIsSfCLQ1Pk06zs4n3nC1dx72iOARLPUOEivfYvtYXF5ciRZaaa4YqU5QoZ3xJDD4Bv7eGhfpw6XT38BMEffw4tYFUuk7IIjMRk6St6R53zRIyU/zGfnDutF+VkKCCLKmcHcYBfGyGKyxthJ2r5HCovX8i4RVjfGD1lHJ3yccGGKRXrgkt5As9NNp/TCsakiJ1dQjFEXcdbYS2vxK9ym3RvgzGTIPwEVm3mbWEttBMi+om/kKaumDdBq6NBTnIo60Ulzzu2nZdqAwFBpsN6Sf6EuMq4U8gdpTqhx8Av8wQAAAABJRU5ErkJggg==",PROCESSING_DATA_URL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADbklEQVQ4T21TbUxTZxR+Lr2FKm2xDYod1ZasgKSzkbSCia1KouimkogLP9YRNkt0kGVKf2hYBAZ+BJVoJEqi/vAjmYSJLiSDfUAQBomDLBCNRWpFxUxp7d0ovY29LZTutFmNyXyTm/ve957nOed53nMYvGfV1v5g37hxfb1czi56PK/H2toazt69+1PP+2KZxGFVVVsux02EZ2c9kcLC8l+i0Wie0ZgHiyUbjY1nxnp6uk6ZTDu4gYHWUa/XG0jg4gSdnfcrCgq0bYKwgImJmajb/SZVJAI2bMjBqlVpePTIjf7++xCJotFgkBtpbq6pCIW4xzFsnODo0RtnGSa1RqfLQnFxPiKRCORyEcLhMPx+AQzDElgMlmXx4oUPNlvZBYejz07Q+ThBSck3O3JzN/0sFotgtW5FTo4UTqcXHk8SJJJkcJwbwSAPnU5PlQzM19eXHRcE/ymChuIEjY3dJ1UqVa0ghFFaakAoFKRMKZQ1CT6fF3q9mmS4MD3NU/TC4pEju6sDAe5SXEJHx/iVrKwPrRw3u4Q0wmxWY2zMB0FgUVdXMcLzkozy8s+1NtvHuHlzGEqlCr29t8dHRn695nQOXmd4PmYM4Hb7oVbLkZQUgsvFYGioj7fbd1Zt315Tkp1tKGtq+gy3bv1BkpZDpcrEvXvDaGr6dC9z+vSNTqNx897k5BRotQoyD1SuQBKeBVtaGs5ZLFbr6tVKzb59Zly9Ooxly9SYm/sH1BfBrq4z1TEPluzZY281Gj+pzMxUkgfr8ODBc6Snq8lED3ngJ1kaPHnyEoODfyEtLY08q/htZsbRTtihuIknTvy4n8q8FAgEsGaNDgpFiACvYDBoqSIWDsdz9PU5ycx1pP+O//LlmoMEuxY3ccuW79jKyvJuvf6DYp9vjo6kWLEilTJz5MUz8Pwb6guW5MXI5HSNvaGWlgM2QeC+TzQSYzZ/fUEmy6o2mT7Crl3bMDU1RW4rIJWm0pWGsbAQpYpcWLpUiocP/8TFi4e+FYS/m4kgmpgFZUaG4SvSbdFqNcuVymyDTKYQFxUVYeVKFc6fb3g5Oto/KZFIJW73pMvvf9VK4PG3rfzOlMloL1+7tvhLjcZ0MD/flE4Lx4590c5xTw/TPyHWSfT4Epi30/gOyX9bcQENVB59pEQi85P0/v3/McC/d5diHn407noAAAAASUVORK5CYII=",DECODING_RESPONSE_DATA_URL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADWklEQVQ4T2WTbWyTVRTH//e5z3vf17mx1naZTrYSAWHgjHG+BFBxhAScGoHwsim6hERjIiEhRKiBL76giUZNigEXMZpoRCSAH9xCYAkUNvYCjBYZ26qrbZG2G23XPuvj3YNriNzc8+XmnF/u+f/PIbj30NZPn3vR66lttJdbG3W9OBlPxS/2n+3/6de958/9P53c/bBy34KWsjm2j6Ws7CkgD0o1UJGDVK6C8hTTYv702FDsraPb+ntm60qA5g8XHCTQN+VuZ2GplSCYKSYTGhzVEtQyAYRlpoamUFHnTI91pVf8/M6d3xiAZ99/uG26oAU0MgWrV4agcnBPNGDt3C34LXwEiYZu441nQaJmcKZi6nQgtDi4f/Q6md9uc7irvMPJv5M2e73CEim8+SVo8bWC4zj0jfZiYN7h/wAUbnMN/rwcRV6bPvzl053rSfOeRW3J6K2AXM1DMHF4AI/ilYWvQ+AF5LQcDkR2Q63PlQBey0PI/6MhlhnHma/DD5KV/ke+vXUjsc5cJ6NWbMSrDVshiqIR3wcPImOPMiEJOJ61IFI4PCosNQQjAxHc6E68TJa95zuVy2ebnLIHbzy2Aw6rA7IkQ5RECIIAnueNVqDPXB1XIoMYX9qJWCyOsaFxP1m+x3cqm2UAxYN3l+2DLMsGQJIlSCJzg0FmALquMycILg73IL24D6EoA12N+ckL/oUd6Whqw4wGdcrjaGt6G4qsoKAX8GOwAylLxPi601wBk2KCVDkNd5ULXRdO4tq5SAtp9i9q5TL0QMaeNESsl5rQ/tR2KAqDFAvYG2xHpU+BzeyAVbXDpdYgGZ3AwM1uHPu8r3xmDmh7YM1wOBzy8PcXDBt9/JPY9sxOqKqKS2MDOKMewn3mKjjVSkPMcCiEvzIjHfubjm40BmnzJ8+/VGF3/XAl1guLS4bZYsJcPIF1jVvRM3IWadc15grTQgCuD0agWSdSJzo6a7s+CiVKo7z9m81vSrz8RSGjoXqeB6qFtTClw1TGXGA23k5mEY/HwJcXU6HekeVfbfzlfGmUZxfjtc9Wr3BW2QKYpF7ZIQGTzHumS1HUwNuAqWz+u2B3/67juy78cc8y3bWVZNXOJUvddZXNWrEgEEp0SunNcO/okd8/GCwVzub/C1MgLl8VCbqbAAAAAElFTkSuQmCC",COMPLETED_DATA_URL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAB4ElEQVQ4T2NkoBAwkqo/aJucNcPffxt/vPsvvC3+qQhJBoA0MzMzbHx3+7fwj7d/jh+tfx1MtAEwzb++/hd+e/n7ye93OU6cXfSkligDYJrFFEWF7x1/wfBqL+PEF3v/T3v69OlDggbANCupKQlfPnSb4efnP8deHfk3+/KK12uB4fcZxQCY4r9/GfzXeT06CuObatkKHz11kOHTw99X35z61wPV/AtowE+4ATDFaWZNwrNO1b0FGQIKMJDmK6+PMry+8pvh1032vr2t99qAGr+ANINiEGwAsmZYtIIMAWm+9/0iw6Pj78FO35vzMgQo/w6qBmFA6E65NyCbQRJvfj+BJ41v/z4xbDi4lOHvDwaGPzd4Qne139yPbDvcBSADGP8xcGhp6XNzMfHBDTh96wjDixPfnrHzMd3fk/syFKr5M3LiA3tBWlpazaCUvYFb/Y/fz2//mUV0OTj+fP/H8O72T4bvT3/fP1L+0fHHjx8gp4MDDsMAoAA70BB5HuPv+nJaIuY8Vj+KWXmAIfXkL8PvB2ypu+vur0d3OswQ5GjkhbpGUiuWO+2nwIdiIQ22zxsCnqhjczo2A0Bi7EDMBnSNJNDJAn/+/Hn78eNHUKiiOBubF5DFYGyQi1ACDJsiAIU/4VHlwvAFAAAAAElFTkSuQmCC",ERROR_DATA_URL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAADZUlEQVQ4T22TbUhbVxjH/+fm3tyb5N6YBtNkGndJfWmrcVqT6dBWtNUycBXW+qGoUJlQV6lbKaPr29Yvc1/GEPdhFMEKgzIo3Sxbi3RtSt0yRTojWGkjTZWqGSFMrY2makzcY7a+bgcOB855zu95/s8Lw/+tt6u2VCva3ZZgUGVIIGGxzX8fjf0E3+3A6+bslQv6+GEk1OlYXHhPkUTYbDaIjCEaCmFpeQWzkvzbNZ3u2K3RYd+zf88BxWXV7r2T92+aHGrK9uZm2F0uGI1GcByH1dVVRHw+BM6fh+J/8KTPuPnYN+O+ng3IPwDX7sxPg+PDqZXlKaVHj8JisYCLxcDCYfAE4O128LKMlbk5DNXXQ5j5E99mZLt/8XmHk4DG7Nx+1WIqLz93DmazGes3bmC9rw+a+XlwwSAEgsmHD0N34gTW6G6wqgohSbnb9tBfwDa8t4YDgeKPP0J6QQHY4CAyamuh1WoxU1cHSaPBm1euYPnpU8QuXIDx5EmEL17E6Gefozm/tIRV7txzvCw8/XXO2bOQKRqJHje3t0NRFMQXFiDpdFAomUskJ1xUBCs5SBDc43RiyPXOF2xXlrO9xGY6vfXQIUiPH0Pu7sYaaTafOgW9Xg8dAbjlZcw2NYH3+2Hu7YWQl4frOTkIO3f8TIDc9qK01NOO/fshkj5DZyc4kwmLbW2QrdYkhF9ZgXjmDNjEBFIoQpEAnsJCzDsL+1lFWdUn7tDkV7YjR8CiUShdXQg1NiIhSbBSGUWCbawNeWJLC1IuXQJHFblTXY0Rp/tLhpK9rqaHI3/kNdQjkZYG/egoZkmCjjyn9vRAVFVEDh6EngBGrxcySYl4PPB3dOC74oq6ZBlrs3K9qsjKHNRAa0tLkAYGwNEWKIkaeufT0yGUlsLQ0AA+HsdgayuikmGq49GEIwnYWlzhdk/eu/PGW/mw79uHOBnxJIefnobA89Bu2waRmotPJDBG1UrMzqE/y3ngV9/vPz5v5Z3OHR+oUxPdkkGP7JoayJQkDfWAIAjJHaHyBS5fhrgaw9j2/JZrQ96uF63872Rs2fXunsLpB92GUFDVUumMmZkAnYvUjZIoYtFmnxo3W48PjAz88J9hemkqmVpe8372XzOVmxjLZxT2k3U2NpmecXvcc7WX7OIvT/Df1VMsmVTz7HQAAAAASUVORK5CYII=",TIMEOUT_DATA_URL:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAC2ElEQVQ4T11TTSisYRR+Xn8zTMICJaWoSZLBKErC2DALZWjEVdYspCykLKynGcrGQrJANIpm5GM1otQ0o+YzfjaIQoZYjMQdjO++59xG133rq9P3vuc853nOcwT+OYqi6D4/Py1fX1/K1dUVzs7OoGkaSkpK+JOxVafT+axWayyRJhKBz+czPTw8qDs7Ozg5OUF6ejpfxeNxpKWlIRqNIj8/H52dncjNza1sbW09pHsusL29bbq8vFRnZ2dRWFiI3t5e1NTUcCwRcX19jWAwiNXVVVBn3d3dMJlMlRaL5VBQ24+Pj79dLhfa29vR39+faBeSCoQQSEpK4m4kCObm5iBzMDY2hqqqKr1YX19v29jYUJ6fnzE1NYWCggJ+TNzpvL29Qa/Xc6Hk5GTc3t5iaGgIOTk5aG5utoqVlRXN4XBgdHQUdrv9G5USqAM61MHr6ytrkZKSgrW1NUxOTnIhMTExofn9fiwuLiI7O5uR6dH/J0GHCt/c3KCnpwc2mw1icHBQOz8/x9bWFicTGj06Pj7G7u4uqqurUVpaiszMTKZAhT4+Plgv+i+Gh4e1QCCA/f19vL+/MzoV2dzcxPLyMurr60H6FBcXo6WlhbkTUFNTE+rq6iCmp6c1t9vNI8rLy2N0+o6OjnB/f4+KigqEQiEYDAaOMzIymEJfXx+6urogPB4PizgyMoKOjg42DiGoqgo5XkjD/JCDutzb24PUjnOERG5bWlpSqHWn04mioiJOIA2enp7Q2NiIl5cXpkXod3d3kLpxLAGt30aamZmhubKRjEYjSNhIJILa2lqkpqZy0dPTUywsLLCRxsfH/xqJLmgPwuGwOj8/j7KyMva72WxmwbKystiB8p51Im0GBgZQXl5e2dDQcPhjmWTLqtfrxcXFBSMSMo0uFovx+Ige6STdysnfy5RQSa6vTopnkY5TaIGIL3GnLZRr/kuO3H1wcGCQixZN5PwBnSVjy2IX6jwAAAAASUVORK5CYII="}};
GIAPI.DABSource=function(e,r){var u=GIAPI.GINode(e,r),o=!0;return u.include=function(u){return void 0!==u&&null!==u&&(u?(Array.prototype.remove(r._includedSources,e.id),r._includedSources.push(e.id)):u||Array.prototype.remove(r._includedSources,e.id),o=u),o||!r._includedSources.length},u};
GIAPI.Concept=function(){var e={},r=arguments[0];e._report=arguments[1],e.extend=function(n,a,l){var p=t(a)||t(l),c=o(a)||o(l),u=GIAPI.concept(r,"",e._report.uri,p,c);jQuery.ajax({type:"GET",url:u,crossDomain:!0,dataType:"jsonp",success:function(t){if(t.resultSet&&t.resultSet.error)return GIAPI.logger.log("extend concept error: "+t.resultSet.error,"error"),n.apply(e,[[],"Error occurred:"+t.resultSet.error]),void 0;GIAPI.logger.log("extend success");for(var o=t.concept,a=[],l=0;l<o.length;l++){var p=o[l],c=GIAPI.Concept(r,p);a.push(c)}n.apply(e,[a])},complete:function(e,r){GIAPI.logger.log("extend concept complete status: "+r)},error:function(r,t,o){t+=o.message?", exception -> "+o.message:"",GIAPI.logger.log("extend concept error: "+t,"error"),n.apply(e,[[],"Error occurred:"+t])}})},e.property=function(t,o){var n=GIAPI.concept(r,"",e._report.uri,[o],null);jQuery.ajax({type:"GET",url:n,crossDomain:!0,dataType:"jsonp",success:function(r){if(r.resultSet&&r.resultSet.error)return GIAPI.logger.log("concept property error: "+r.resultSet.error,"error"),t.apply(e,[null,"Error occurred:"+r.resultSet.error]),void 0;GIAPI.logger.log("concept property success");var n=r.properties&&r.properties.values?r.properties.values:null,a=null;n&&(a={name:o,values:n}),t.apply(e,[a])},complete:function(e,r){GIAPI.logger.log("concept property complete status: "+r)},error:function(r,o,n){o+=n.message?", exception -> "+n.message:"",GIAPI.logger.log("concept property error: "+o,"error"),t.apply(e,[[],"Error occurred:"+o])}})},e.uri=function(){return e._report.uri},e.label=function(){return e._report.label},e.extensionSize=function(r){return e.maxExtensionSize(r)},e.maxExtensionSize=function(r){r||(r="all");var t=0;return(r.value===GIAPI.Relation.BROAD_MATCH.value||"all"===r)&&(t+=parseInt(e._report.relatedConcepts_broadMatch?e._report.relatedConcepts_broadMatch:"0")),(r.value===GIAPI.Relation.BROADER.value||"all"===r)&&(t+=parseInt(e._report.relatedConcepts_broader?e._report.relatedConcepts_broader:"0")),(r.value===GIAPI.Relation.CLOSE_MATCH.value||"all"===r)&&(t+=parseInt(e._report.relatedConcepts_closeMatch?e._report.relatedConcepts_closeMatch:"0")),(r.value===GIAPI.Relation.EXACT_MATCH.value||"all"===r)&&(t+=parseInt(e._report.relatedConcepts_exactMatch?e._report.relatedConcepts_exactMatch:"0")),(r.value===GIAPI.Relation.NARROW_MATCH.value||"all"===r)&&(t+=parseInt(e._report.relatedConcepts_narrowMatch?e._report.relatedConcepts_narrowMatch:"0")),(r.value===GIAPI.Relation.NARROWER.value||"all"===r)&&(t+=parseInt(e._report.relatedConcepts_narrower?e._report.relatedConcepts_narrower:"0")),(r.value===GIAPI.Relation.NONE.value||"all"===r)&&(t+=0),(r.value===GIAPI.Relation.RELATED.value||"all"===r)&&(t+=parseInt(e._report.relatedConcepts_related?e._report.relatedConcepts_related:"0")),(r.value===GIAPI.Relation.RELATED_MATCH.value||"all"===r)&&(t+=parseInt(e._report.relatedConcepts_relatedMatch?e._report.relatedConcepts_relatedMatch:"0")),t},e.description=function(){return e._report.description},e.sourceThesaurus=function(){return e._report.sourceThesaurus},e.rootRelation=function(){return e._report.rootRelation},e.stringify=function(){return JSON.stringify(e._report,null,4)};var t=function(e){return e&&Array.isArray(e)?e:null},o=function(e){return e&&(e.start||e.count)?e:null};return e};
GIAPI.Relation={NONE:{name:"None",value:"none"},NARROWER:{name:"Narrower",value:"skos%3Anarrower"},BROADER:{name:"Broader",value:"skos%3Abroader"},NARROW_MATCH:{name:"Narrow match",value:"skos%3AnarrowMatch"},BROAD_MATCH:{name:"Broad match",value:"skos%3AbroadMatch"},CLOSE_MATCH:{name:"Close match",value:"skos%3AcloseMatch"},RELATED:{name:"Related",value:"skos%3Arelated"},RELATED_MATCH:{name:"Related match",value:"skos%3ArelatedMatch"},EXACT_MATCH:{name:"Exact match",value:"skos%3AexactMatch"},decode:function(e){switch(e){case this.NONE.value:return this.NONE;case this.NARROWER.value:return this.NARROWER;case this.BROADER.value:return this.BROADER;case this.NARROW_MATCH.value:return this.NARROW_MATCH;case this.BROAD_MATCH.value:return this.BROAD_MATCH;case this.CLOSE_MATCH.value:return this.CLOSE_MATCH;case this.RELATED.value:return this.RELATED;case this.RELATED_MATCH.value:return this.RELATED_MATCH;case this.EXACT_MATCH.value:return this.EXACT_MATCH}throw"Unable to decode "+e}};
GIAPI.PropertyName={SCOPE_NOTE:"skos%3AscopeNote",NOTE:"skos%3Anote",NOTATION:"skos%3Anotation",ALT_LABEL:"skos%3AaltLabel",CHANGE_NOTE:"skos%3AchangeNote"};
GIAPI.GINodeTree=function(e,o,t){var r=t&&t.onLoadComplete,n=t&&t.onCreateNode?t.onCreateNode:function(e,o,t,r){var n=e.report().title;return t&&(n="Click to get more results..."),n},a=t&&t.pageSize?t.pageSize:10,d=function(e){var o=function(o,a){for(var d,p=o.nodes(),l=[],u=0;p&&u<p.length;u++){var v=p[u],f=v.report().type,g=n(v,e,!1,!1),N=new YAHOO.widget.HTMLNode(g,e,!1,!0);if(N.data=v,N.isLeaf="simple"===f,l.push(N),u===p.length-1&&v._parent&&v._parent.expandNext()){var g=n(v,e,!0,!1);d=new YAHOO.widget.HTMLNode(g,e,!1,!0),d.data=v._parent,d.isLeaf=!1,d._expandNext=!0}i.nodeToRemove&&(i.tree.removeNode(i.nodeToRemove,!0),i.nodeToRemove=null)}a.error&&t&&t.onError.apply(this,[e,a.error]),e.loadComplete(),r&&r.apply(this,[o,l,d])};e._expandNext?(e.data.expandNext(o,!0),i.nodeToRemove=e):e.data.expand(o,a)};t&&t.onError||(onError=function(e,o){e.label=e.label+" ("+o+")",i.tree.draw()});var i={};i.tree=new YAHOO.widget.TreeView(o),i.tree.setDynamicLoad(d);var p=n(e,i.tree.getRoot(),!1,!0);return i.treeRoot=new YAHOO.widget.HTMLNode(p,i.tree.getRoot(),!1,!0),i.treeRoot.data=e,i.tree.draw(),i.onLoadComplete=function(e){return r=e},i.onCreateNode=function(e){return e&&(n=e),n},i.pageSize=function(e){return a=e},i};
GIAPI.ConceptTree=function(e,t,r){var o=r&&r.keyword,n=r&&r.onLoadComplete,a=r&&r.onCreateNode?r.onCreateNode:function(e,t,r){var o=null;return o=r?e.report().title:e.uri()},i=function(e){var t=function(t,r){for(var o=[],i=0;i<t.length;i++){var d=t[i],l=(d.uri(),a(d,e,!1)),u=new YAHOO.widget.HTMLNode(l,e,!1,!0);u.data=d,u.isLeaf=!1,o.push(u)}r&&onError.apply(this,[e,r]),e.loadComplete(),n&&n.apply(this,[o])},r=e.data;r.extend?e.relation?r.extend(t,e.relation):r.extend(t):r.concept(o,t)};onError=r&&r.onError?r.onError:function(e,t){e.label=e.label+" ("+t+")",d.tree.draw()};var d={};d.tree=new YAHOO.widget.TreeView(t),d.tree.setDynamicLoad(i);var l=a(e,d.tree.getRoot(),!0);return d.treeRoot=new YAHOO.widget.HTMLNode(l,d.tree.getRoot(),!1,!0),d.treeRoot.data=e,d.tree.draw(),d.conceptKeyword=function(e){return e&&(o=e),o},d.onCreateNode=function(e){return e&&(a=e),a},d.onLoadComplete=function(e){return n=e},d.relationExtension=function(e,t){return t&&(e.relation=t),e.relation},d};